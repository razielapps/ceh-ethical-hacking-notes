Of course. Let's dive into one of the most classic and fundamental DoS attacks.

Topic 54: SYN Flood Attack

A SYN Flood is a type of Denial-of-Service attack that targets the very foundation of a TCP connection: the three-way handshake. It exploits a design feature of the TCP protocol to exhaust resources on the target server.

To understand the attack, you must first remember the normal TCP three-way handshake:
1.  The client sends a SYN (synchronize) packet to the server.
2.  The server responds with a SYN-ACK (synchronize-acknowledge) packet and allocates a small amount of memory (in a "connection queue") to track this half-open connection.
3.  The client completes the handshake by sending an ACK (acknowledge) packet. The connection is now fully established and moved out of the queue.

A SYN Flood attack disrupts this process at step 2.

**How a SYN Flood Works:**

1.  **Weaponized SYNs:** The attacker sends a rapid succession of TCP SYN packets to the target server. The key to the attack is that these SYN packets have a **spoofed source IP address**. The attacker does not use their real IP; they forge it, making the packets appear to come from random, non-existent, or unreachable machines on the internet.

2.  **The Server's Obligation:** For each of these SYN packets, the target server, following the protocol, does its job:
    - It sends a SYN-ACK response back to the *spoofed* source IP.
    - It allocates a small chunk of memory to track this pending connection and waits for the final ACK.

3.  **The Trap:** The final ACK never arrives. Why? Because the SYN-ACK was sent to a random/spoofed IP address that never actually sent the original SYN request. That machine will either ignore the unexpected SYN-ACK or send a RST (reset) packet, which the target server ignores as it's waiting for an ACK.

4.  **Resource Exhaustion:** The attacker continues to send thousands of these spoofed SYN packets per second. The server's connection queue, which has a finite size, quickly fills up with these half-open connections. Once the queue is full, the server cannot accept any new legitimate connection requests. It is effectively "locked up," and legitimate users receive "connection timed out" errors.

This is an example of a **Resource Depletion** attack. The attacker isn't necessarily using all the bandwidth; they are consuming a specific, limited resource on the server (the connection state table).

**Why It's Effective:**
- It's simple to execute with tools like `hping3`.
- It uses very little bandwidth from the attacker's side to cause a major outage.
- Because the source IPs are spoofed, it is difficult to block the attack at the source.

For an ethical hacker, demonstrating a SYN flood in a controlled lab environment shows a client the importance of configuring their systems and network devices to withstand such a basic but potent attack.

Glossary for Topic 54:

SYN Flood: A DoS attack that exploits the TCP three-way handshake by sending a flood of SYN packets with spoofed source IP addresses, exhausting the target's connection queue.

TCP Three-Way Handshake: The process of establishing a TCP connection, involving SYN, SYN-ACK, and ACK packets.

Spoofed IP Address: A forged source IP address in a packet's header to conceal the identity of the sender.

Half-Open Connection: A connection that is stuck in the middle of the three-way handshake, having received a SYN and sent a SYN-ACK, but awaiting the final ACK.

Connection Queue: A buffer in a server's operating system where it stores information about incomplete (half-open) connections.

Resource Depletion: A class of DoS attacks aimed at exhausting a system's resources (memory, CPU, connections) rather than its bandwidth.

hping3: A powerful command-line packet crafting and analysis tool that can be used to perform a SYN flood.

Hands-On Assignment for Topic 54:

Your objective is to understand the mechanics of a SYN Flood attack by planning and analyzing it in a lab environment.

1.  **Attack Command Construction:**
    - The tool `hping3` is commonly used for this. Research and write down the `hping3` command that would launch a SYN flood against a target IP `192.168.1.100` on port 80, using a spoofed source IP.
    - Command: `hping3 -S -p 80 --flood --rand-source 192.168.1.100`
    - Breakdown:
        - `-S`: Sets the SYN flag.
        - `-p 80`: Targets port 80 (HTTP).
        - `--flood`: Sends packets as fast as possible.
        - `--rand-source`: Uses random, spoofed source IP addresses.

2.  **Traffic Analysis:**
    - If you were to capture this attack with Wireshark on the target server, what would you see?
    - Describe the pattern: "I would see a massive flood of TCP SYN packets arriving from thousands of different, seemingly random IP addresses, all destined for port 80 of the target server."

3.  **Server-Side Impact:**
    - On the target Linux server, what command could you run to see the status of the connection queue and observe it filling up with half-open connections?
    - Command: `netstat -tunp | grep SYN_RECV | wc -l`
    - This command counts the number of connections in the `SYN_RECV` state, which is the state of a half-open connection waiting for the final ACK.

4.  **The Attacker's Advantage:**
    - Why does spoofing the source IP address make this attack so much more powerful and difficult to stop than if the attacker used their real IP?
    - Answer: "Because the server's responses (SYN-ACKs) are sent to the spoofed IPs and are lost, never completing the handshake. It also makes simple source-IP blacklisting ineffective, as the attack appears to come from everywhere at once."

5.  **Conceptual Mitigation:**
    - Think about the problem. The server is waiting for an ACK that will never come. What could a network device (like a firewall) do to help?
    - Idea: "The firewall could act as a proxy. It could complete the TCP handshake with the client on behalf of the server first, and only once the handshake is fully complete, establish a separate connection to the real server. This ensures only legitimate, fully-established connections reach the server." (This is the concept behind TCP proxies and SYN cookies).

This assignment ensures you understand the SYN flood not just as a command, but as a manipulation of a core network protocol. You can now explain its mechanism, its effect, and begin to think about how to defend against it.

Are you ready to proceed to Topic 55: Smurf Attack?